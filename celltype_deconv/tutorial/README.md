# Tutorial
A simple example of the library is provided in this `tutorial` folder. All paths mentioned henceforth are relative to the `tutorial` folder. 
The basis matrix is provided in `data/tsp_v1_basisMatrix.txt`. The library allows us to find coefficients of the basis vectors in the basis matrix that best fit the data in `data/samples.csv`. 
`utils/sh_1.py` generates the shell (`.sh`) files that are used by Slurm jobs. The files generated from a run of the `utils/sh_1.py` script on the `samples_test.csv` files are provided in the `shfiles` directory. Slurm jobs to run these shell scripts can be individually submitted by running `sbatch shfiles/[SHFILENAME].sh`. Alternatively, one can run `for i in *.sh ; do sbatch $i ; done` to submit all shell scripts in a folder.

A single run of the code is necessary for each of the columns of the `samples.csv` file corresponding to a single sample. In our particular example, the `samples_test.csv` file has three columns - `sample1`, `sample2`, and `sample3`. Note that this is a synthetic mixture intended for demonstration. The samples have already been CPM normalized, so no further CPM normalization is performed. Therefore, three runs of the code, and consequently three `*.sh` files, are needed. The outputs of the respective runs are provided in the respective subdirectory of the `outputs` directory. The deconvolutionCoefs for each sample represent the proportion of each cell type that, when multipled with the support vectors, provides the best estimate for the gene expression in a particular sample. The supportVectors.csv file represents the subset of the rows of basis matrix that are multipled with the deconvolutionCoefs to produce a best estimate of the gene expression in a particular sample. They correspond to the expression of a subset of genes in all of the cell types represented in the basis matrix. Finally, the gene_preds.csv is the predicted expression of genes in the sample and is generated by multiplying the support vectors by the deconvolution coefficients; these predictions can be compared with the true gene expression that is known.

Finally, in the `outputs` folder, run `../../core/merge_2.py`. The resulting files provide the set of fractions, support vectors, and predictions of gene expressions for the C/nu combination that minimizes the RMSE for each sample. 
